
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Object detection Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.0">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="data-preparation.html" />
    
    
    <link rel="prev" href="../image_similarity/export-coreml.html" />
    

    <script src="../turi/js/jquery/jquery-2.1.3.min.js"></script>
    <script src="../turi/js/d3/d3.min.js"></script>
    <script src="../supervised-learning/images/random-utils.js"></script>
    <script src="../supervised-learning/images/plotting-utils.js"></script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../sframe/">
            
                <a href="../sframe/">
            
                    
                    Working with data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../sframe/tabular-data.html">
            
                <a href="../sframe/tabular-data.html">
            
                    
                    Tabular data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../sframe/sframe-intro.html">
            
                <a href="../sframe/sframe-intro.html">
            
                    
                    Loading and Saving
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../sframe/data-manipulation.html">
            
                <a href="../sframe/data-manipulation.html">
            
                    
                    Data Manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../data_formats_and_sources/sql_integration.html">
            
                <a href="../data_formats_and_sources/sql_integration.html">
            
                    
                    SQL Databases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../sgraph/sgraph.html">
            
                <a href="../sgraph/sgraph.html">
            
                    
                    Graph data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../text/analysis.html">
            
                <a href="../text/analysis.html">
            
                    
                    Text data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../vis/">
            
                <a href="../vis/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../vis/gallery.html">
            
                <a href="../vis/gallery.html">
            
                    
                    Example Gallery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../vis/use_cases.html">
            
                <a href="../vis/use_cases.html">
            
                    
                    Sample Use Cases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../applications/">
            
                <a href="../applications/">
            
                    
                    Task focused toolkits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../recommender/">
            
                <a href="../recommender/">
            
                    
                    Recommender systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../recommender/using-trained-models.html">
            
                <a href="../recommender/using-trained-models.html">
            
                    
                    Using models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../recommender/choosing-a-model.html">
            
                <a href="../recommender/choosing-a-model.html">
            
                    
                    Choosing a model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../recommender/coreml-deployment.html">
            
                <a href="../recommender/coreml-deployment.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../image_classifier/">
            
                <a href="../image_classifier/">
            
                    
                    Image classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../image_classifier/advanced-usage.html">
            
                <a href="../image_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../image_classifier/how-it-works.html">
            
                <a href="../image_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../image_classifier/export-coreml.html">
            
                <a href="../image_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../drawing_classifier/">
            
                <a href="../drawing_classifier/">
            
                    
                    Drawing Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../drawing_classifier/how-it-works.html">
            
                <a href="../drawing_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../drawing_classifier/data-preparation.html">
            
                <a href="../drawing_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../drawing_classifier/export-coreml.html">
            
                <a href="../drawing_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../drawing_classifier/advanced-usage.html">
            
                <a href="../drawing_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../sound_classifier/">
            
                <a href="../sound_classifier/">
            
                    
                    Sound Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../sound_classifier/how-it-works.html">
            
                <a href="../sound_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../sound_classifier/advanced-usage.html">
            
                <a href="../sound_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../sound_classifier/export-coreml.html">
            
                <a href="../sound_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../image_similarity/">
            
                <a href="../image_similarity/">
            
                    
                    Image similarity
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../image_similarity/export-coreml.html">
            
                <a href="../image_similarity/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3.6" data-path="./">
            
                <a href="./">
            
                    
                    Object detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="data-preparation.html">
            
                <a href="data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="advanced-usage.html">
            
                <a href="advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.3" data-path="export-coreml.html">
            
                <a href="export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.4" data-path="how-it-works.html">
            
                <a href="how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../style_transfer/">
            
                <a href="../style_transfer/">
            
                    
                    Style transfer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.7.1" data-path="../style_transfer/how-it-works.html">
            
                <a href="../style_transfer/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.2" data-path="../style_transfer/export-coreml.html">
            
                <a href="../style_transfer/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../activity_classifier/">
            
                <a href="../activity_classifier/">
            
                    
                    Activity classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.8.1" data-path="../activity_classifier/data-preparation.html">
            
                <a href="../activity_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.2" data-path="../activity_classifier/advanced-usage.html">
            
                <a href="../activity_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.3" data-path="../activity_classifier/export_coreml.html">
            
                <a href="../activity_classifier/export_coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.4" data-path="../activity_classifier/how-it-works.html">
            
                <a href="../activity_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../text_classifier/">
            
                <a href="../text_classifier/">
            
                    
                    Text classifier
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../modeling-data/">
            
                <a href="../modeling-data/">
            
                    
                    Machine learning essentials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../supervised-learning/classifier.html">
            
                <a href="../supervised-learning/classifier.html">
            
                    
                    Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../supervised-learning/boosted_trees_classifier.html">
            
                <a href="../supervised-learning/boosted_trees_classifier.html">
            
                    
                    Boosted Trees Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../supervised-learning/decision_tree_classifier.html">
            
                <a href="../supervised-learning/decision_tree_classifier.html">
            
                    
                    Decision Tree Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../supervised-learning/logistic-regression.html">
            
                <a href="../supervised-learning/logistic-regression.html">
            
                    
                    Logistic Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../supervised-learning/knn_classifier.html">
            
                <a href="../supervised-learning/knn_classifier.html">
            
                    
                    Nearest Neighbor Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../supervised-learning/random_forest_classifier.html">
            
                <a href="../supervised-learning/random_forest_classifier.html">
            
                    
                    Random Forest Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.6" data-path="../supervised-learning/svm.html">
            
                <a href="../supervised-learning/svm.html">
            
                    
                    SVM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.7" data-path="../supervised-learning/export-coreml.html">
            
                <a href="../supervised-learning/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../clustering/">
            
                <a href="../clustering/">
            
                    
                    Clustering
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../clustering/kmeans.html">
            
                <a href="../clustering/kmeans.html">
            
                    
                    KMeans
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../clustering/dbscan.html">
            
                <a href="../clustering/dbscan.html">
            
                    
                    DBSCAN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../graph_analytics/">
            
                <a href="../graph_analytics/">
            
                    
                    Graph analytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../nearest_neighbors/nearest_neighbors.html">
            
                <a href="../nearest_neighbors/nearest_neighbors.html">
            
                    
                    Nearest neighbors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../supervised-learning/regression.html">
            
                <a href="../supervised-learning/regression.html">
            
                    
                    Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../supervised-learning/boosted_trees_regression.html">
            
                <a href="../supervised-learning/boosted_trees_regression.html">
            
                    
                    Boosted Trees Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../supervised-learning/decision_tree_regression.html">
            
                <a href="../supervised-learning/decision_tree_regression.html">
            
                    
                    Decision Tree Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.3" data-path="../supervised-learning/linear-regression.html">
            
                <a href="../supervised-learning/linear-regression.html">
            
                    
                    Linear Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.4" data-path="../supervised-learning/random_forest_regression.html">
            
                <a href="../supervised-learning/random_forest_regression.html">
            
                    
                    Random Forest Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.5" data-path="../supervised-learning/export-coreml.html">
            
                <a href="../supervised-learning/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../text/">
            
                <a href="../text/">
            
                    
                    Text analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../evaluation/">
            
                <a href="../evaluation/">
            
                    
                    Evaluating models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../evaluation/regression.html">
            
                <a href="../evaluation/regression.html">
            
                    
                    Regression metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../evaluation/classification.html">
            
                <a href="../evaluation/classification.html">
            
                    
                    Classification metrics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../conclusion.html">
            
                <a href="../conclusion.html">
            
                    
                    Additional Resources
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../cpp.html">
            
                <a href="../cpp.html">
            
                    
                    C++ API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../datasets.html">
            
                <a href="../datasets.html">
            
                    
                    Dataset Disclaimer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Object detection</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="object-detection"><a name="object-detection" class="plugin-anchor" href="#object-detection"><i class="fa fa-link" aria-hidden="true"></i></a>Object Detection</h1><p>Object detection is the task of simultaneously classifying (<em>what</em>) and
localizing (<em>where</em>) object instances in an image. Given an image, a
detector will produce instance predictions that may look something like this:</p><p><img alt="Two dogs each with a predicted bounding box around their face" src="images/dogs.jpg"></p><p>This particular model was instructed to detect instances of animal faces.
The notion of localization is here provided by bounding boxes around the
instances.</p><h4 id="introductory-example"><a name="introductory-example" class="plugin-anchor" href="#introductory-example"><i class="fa fa-link" aria-hidden="true"></i></a>Introductory Example</h4><p>In this example, the goal is to <strong>predict</strong> if there are <strong>bikes or cars</strong> in a
picture and where in the picture they are located (Go to <a href="data-preparation.html">Data
Preparation</a> to find out how to get <code>ig02.sframe</code>).</p><pre><code class="lang-python"><span class="hljs-keyword">import</span> turicreate <span class="hljs-keyword">as</span> tc

<span class="hljs-comment"># Load the data</span>
data =  tc.SFrame(<span class="hljs-string">&apos;ig02.sframe&apos;</span>)

<span class="hljs-comment"># Make a train-test split</span>
train_data, test_data = data.random_split(<span class="hljs-number">0.8</span>)

<span class="hljs-comment"># Create a model</span>
model = tc.object_detector.create(train_data)

<span class="hljs-comment"># Save predictions to an SArray</span>
predictions = model.predict(test_data)

<span class="hljs-comment"># Evaluate the model and save the results into a dictionary</span>
metrics = model.evaluate(test_data)

<span class="hljs-comment"># Save the model for later use in Turi Create</span>
model.save(<span class="hljs-string">&apos;mymodel.model&apos;</span>)

<span class="hljs-comment"># Export for use in Core ML</span>
model.export_coreml(<span class="hljs-string">&apos;MyCustomObjectDetector.mlmodel&apos;</span>)</code></pre>
<h4 id="data-acquisition"><a name="data-acquisition" class="plugin-anchor" href="#data-acquisition"><i class="fa fa-link" aria-hidden="true"></i></a>Data Acquisition</h4><p>The introductory example creates a model assuming the data already exists, but before we create our model, 
we require labeled data. This data should consist of images and <em>ground truth</em>
annotations (correct class label and bounding box for each instance). The more data we
have, the better our predictions will be. Ground truth data should look similar
to prediction data, at least what you hope it will look like. Here is an example:</p><p><img alt="Two balls and a cup with ground truth bounding boxes" src="images/ground_truth.jpg"></p><p>In this particular example, we chose <em>ball</em> and <em>cup</em> to be object classes. Each
instance of these objects therefore gets a ground truth bounding box. In this scenario we are not
interested in detecting fruit, so we leave them unmarked. You should decide a
list of object classes of interest, preferably in advance. If you start marking
up all potentially interesting objects in your training images, you may end up with
classes with very few samples. Alternatively, you can annotate as much as you
want and then pass a list of classes to <code>create</code> using the <code>classes</code> parameter;
object instances not covered in this list will simply be ignored.</p><p>The ground truth annotations for the image above should be encoded as a list
of dictionaries, each dictionary representing a single bounding box:</p><pre><code class="lang-python">[{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;height&apos;</span>: <span class="hljs-number">104</span>, <span class="hljs-string">&apos;width&apos;</span>: <span class="hljs-number">110</span>, <span class="hljs-string">&apos;x&apos;</span>: <span class="hljs-number">115</span>, <span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">216</span>},
  <span class="hljs-string">&apos;label&apos;</span>: <span class="hljs-string">&apos;ball&apos;</span>},
 {<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;height&apos;</span>: <span class="hljs-number">106</span>, <span class="hljs-string">&apos;width&apos;</span>: <span class="hljs-number">110</span>, <span class="hljs-string">&apos;x&apos;</span>: <span class="hljs-number">188</span>, <span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">254</span>},
  <span class="hljs-string">&apos;label&apos;</span>: <span class="hljs-string">&apos;ball&apos;</span>},
 {<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;height&apos;</span>: <span class="hljs-number">164</span>, <span class="hljs-string">&apos;width&apos;</span>: <span class="hljs-number">131</span>, <span class="hljs-string">&apos;x&apos;</span>: <span class="hljs-number">374</span>, <span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">169</span>},
  <span class="hljs-string">&apos;label&apos;</span>: <span class="hljs-string">&apos;cup&apos;</span>}]</code></pre>
<p>You may optionally include <code>&apos;type&apos;: &apos;rectangle&apos;</code> to explicitly denote these as
bounding boxes. If <code>type</code> is defined as something else, the object detector
will ignore that dictionary.  A bounding box is defined by four values (<em>x</em>,
<em>y</em>, <em>width</em>, <em>height</em>) where (0, 0) is the top left corner. The center of the
box is located at (<em>x</em>, <em>y</em>):</p><p><img alt="Visual description of (x, y, width, height)" src="images/xywh.png"></p><p>It is customary for bounding boxes to tightly surround instances. However, this
is only a convention and it is entirely up to you and your training data to
define how instances should be represented as boxes. If you for instance only need to
predict the center of objects, feel free to set all widths/heights to a
token value (e.g. 100) in your training data.</p><p>It is up to you to choose how many bounding boxes you define for each image.
However, try to be consistent with your notion of instances. If you are trying
to detect persons, then every occurrence of a person should warrant a ground
truth bounding box. If you leave some persons unmarked, the model can get
confused why some persons are marked as positives (presence of an instance)
while others are marked as negatives (absence of an instance). If you want, you
may include images without any bounding boxes whatsoever (pure negatives),
granted that no instances appear in those images. This can be an effective way
of reducing false positives. For instance, if you train a model to detect balls
and the training set you provide never includes other round objects, you may
find that your model starts assigning high confidence of <em>ball</em> to other
similar objects. In the photo above, the presence of an apple and a clementine
may actually help to prevent such mistakes, even though they are not marked up
explicitly.</p><p>The lists of bounding boxes should be placed inside an SFrame alongside the
images:</p><pre><code class="lang-python">+------------------------+-------------------------------+
|         image          |          annotations          |
+------------------------+-------------------------------+
| Height: <span class="hljs-number">375</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">204.</span>.. |
| Height: <span class="hljs-number">375</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">148.</span>.. |
| Height: <span class="hljs-number">334</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">146.</span>.. |
| Height: <span class="hljs-number">500</span> Width: <span class="hljs-number">345</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">321.</span>.. |
| Height: <span class="hljs-number">480</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">301.</span>.. |
| Height: <span class="hljs-number">375</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">121.</span>.. |
| Height: <span class="hljs-number">335</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">119.</span>.. |
| Height: <span class="hljs-number">335</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">150.</span>.. |
| Height: <span class="hljs-number">500</span> Width: <span class="hljs-number">333</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">235.</span>.. |
| Height: <span class="hljs-number">333</span> Width: <span class="hljs-number">500</span> | [{<span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">120.</span>.. |
+------------------------+-------------------------------+
[<span class="hljs-number">1821</span> rows x <span class="hljs-number">2</span> columns]</code></pre>
<p>When arranging your data, keep in mind that the model can be quite literal in
its interpretation of the task. Please keep these following considerations in mind:</p><ol><li><p>The data should be varied. Use many photos of your object instances in
different contexts, from a variety of angles and scales, lighting
conditions, etc. If you only have photos of your object from the same pose
(e.g. person facing the camera), then at test time it will likely fail to
make a detection if a different pose is presented (e.g. person looking
away). Unless you specifically want the detector to have such behavior, you
will need to vary the pose in your training data. If you use broad categories
of objects, such as a <em>cup</em> or <em>dog</em>, include a wide variety of types of cups
and breeds of dogs.</p></li>
<li><p>The ground truth data should be representative of the actual use case data. For instance,
if you take photos of a catalog of products only inside a warehouse, it may not
work well if your users are making predictions inside a store.</p></li></ol>
<p>You can expect to need at least 30 samples (bounding boxes) per object class,
but even that will be too few for many challenging tasks. For high quality
results, plan to have closer to 200 samples per class.</p><p>Once you have arranged your data, it is worth visually checking that the bounding boxes
match your expectations:</p><pre><code class="lang-python">data[<span class="hljs-string">&apos;image_with_ground_truth&apos;</span>] = \
    tc.object_detector.util.draw_bounding_boxes(data[<span class="hljs-string">&apos;image&apos;</span>], data[<span class="hljs-string">&apos;annotations&apos;</span>])
data.explore()</code></pre>
<p><img alt="Ground truth bounding boxes visualized" src="images/explore_ground_truth.png"></p><h4 id="model-creation"><a name="model-creation" class="plugin-anchor" href="#model-creation"><i class="fa fa-link" aria-hidden="true"></i></a>Model Creation</h4><p>Once the ground truth data is ready, creating the model is easy:</p><pre><code class="lang-python">model = tc.object_detector.create(data, feature=<span class="hljs-string">&apos;image&apos;</span>, annotations=<span class="hljs-string">&apos;annotations&apos;</span>)</code></pre>
<p>Model creation may take time. If you do not have access to a GPU, it can take
as much as a day to train a good model. Progress will be continuously printed to
give you a sense of the time it will take. The number of training iterations is
determined automatically based on the size of your dataset. If you want to
lower this value to make model creation faster, you can change it by manually
passing <code>max_iterations</code> to <code>create</code>.  This may lead to a model with inferior
prediction results. To know for sure, we will soon discuss how to do
quantitative model evaluation. Before that, let us make some predictions on
images so far unseen by the model.</p><h4 id="making-predictions"><a name="making-predictions" class="plugin-anchor" href="#making-predictions"><i class="fa fa-link" aria-hidden="true"></i></a>Making Predictions</h4><p>If <code>images</code> is a list of <code>tc.Image</code> instances, we can make predictions:</p><pre><code class="lang-python">test = tc.SFrame({<span class="hljs-string">&apos;image&apos;</span>: images})
test[<span class="hljs-string">&apos;predictions&apos;</span>] = model.predict(test)</code></pre>
<p>The new column with predictions is in the same format as ground truth
annotations. The only difference is that the bounding box dictionaries now
include an entry for prediction confidence:</p><pre><code class="lang-python">[{<span class="hljs-string">&apos;confidence&apos;</span>: <span class="hljs-number">0.7225357099539148</span>,
  <span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;height&apos;</span>: <span class="hljs-number">73.92794444010806</span>,
                  <span class="hljs-string">&apos;width&apos;</span>: <span class="hljs-number">90.45315889211807</span>,
                  <span class="hljs-string">&apos;x&apos;</span>: <span class="hljs-number">262.2198759929745</span>,
                  <span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">155.496952970812</span>},
  <span class="hljs-string">&apos;label&apos;</span>: <span class="hljs-string">&apos;dog&apos;</span>,
  <span class="hljs-string">&apos;type&apos;</span>: <span class="hljs-string">&apos;rectangle&apos;</span>},
 {<span class="hljs-string">&apos;confidence&apos;</span>: <span class="hljs-number">0.5670584769557776</span>,
  <span class="hljs-string">&apos;coordinates&apos;</span>: {<span class="hljs-string">&apos;height&apos;</span>: <span class="hljs-number">82.3002741887019</span>,
                  <span class="hljs-string">&apos;width&apos;</span>: <span class="hljs-number">96.48565420737631</span>,
                  <span class="hljs-string">&apos;x&apos;</span>: <span class="hljs-number">85.07887845066891</span>,
                  <span class="hljs-string">&apos;y&apos;</span>: <span class="hljs-number">237.6466784964736</span>},
  <span class="hljs-string">&apos;label&apos;</span>: <span class="hljs-string">&apos;dog&apos;</span>,
  <span class="hljs-string">&apos;type&apos;</span>: <span class="hljs-string">&apos;rectangle&apos;</span>}]</code></pre>
<p>You can also use the same function that we used to visualize the ground truth
annotations to visually inspect our predictions:</p><pre><code class="lang-python">test[<span class="hljs-string">&apos;image_with_predictions&apos;</span>] = \
    tc.object_detector.util.draw_bounding_boxes(test[<span class="hljs-string">&apos;image&apos;</span>], test[<span class="hljs-string">&apos;predictions&apos;</span>])
test[[<span class="hljs-string">&apos;image&apos;</span>, <span class="hljs-string">&apos;image_with_predictions&apos;</span>]].explore()</code></pre>
<p><img alt="Predicted bounding boxes visualized" src="images/explore_predictions.png"></p><p>Another useful way to inspect predictions is to convert them to <em>stacked
format</em>, which is an SFrame where each row represents a bounding box (see
<a href="advanced-usage.html#stacked">Advanced Usage</a>).</p><h4 id="evaluation"><a name="evaluation" class="plugin-anchor" href="#evaluation"><i class="fa fa-link" aria-hidden="true"></i></a>Evaluation</h4><p>In image classification, an evaluation score of 90% <em>accuracy</em> means we can
expect the model to make the correct prediction in 9 out of 10 images. For
object detection we report <em>mean average precision</em> (mAP), which is not nearly
as intuitive. The main take aways of using this metric are:</p><ul><li>It is a value between 0 and 1 (or 0% and 100%), with higher being better.
</li>
<li>Use the quantitative metric primarily as a relative measure between different
models (training time, sample size, etc.). A single value will not give you
a sense of whether or not the detector is good enough for your use case.
Rely on qualitative prediction examples for that. However, if you train
a new model that improves your mAP metric from 47% to 55%, you know that
the new model is stronger without having to look through images and make a
difficult judgement call.
</li></ul>
<p>We describe this metric in more detail in the <a href="advanced-usage.html">Advanced
Usage</a> section, where we also cover using Core ML
to deploy your detector to iOS and macOS.</p><h4 id="using-gpus"><a name="using-gpus" class="plugin-anchor" href="#using-gpus"><i class="fa fa-link" aria-hidden="true"></i></a>Using GPUs</h4><p>GPUs can make creating an object detection model much faster. If you have
macOS 10.14 or higher, Turi Create will automatically use an available discrete
GPU. (Integrated Intel GPUs are not supported.) If your Linux machine has an
NVIDIA GPU, you can setup Turi Create to use the GPU,
<a href="https://github.com/apple/turicreate/blob/master/LinuxGPU.md" target="_blank">see instructions</a>.</p><p>The <code>turicreate.config.set_num_gpus</code> function allows you to control if GPUs are used:</p><pre><code class="lang-python"><span class="hljs-comment"># Use all GPUs (default)</span>
turicreate.config.set_num_gpus(<span class="hljs-number">-1</span>)

<span class="hljs-comment"># Use only 1 GPU</span>
turicreate.config.set_num_gpus(<span class="hljs-number">1</span>)

<span class="hljs-comment"># Use CPU</span>
turicreate.config.set_num_gpus(<span class="hljs-number">0</span>)</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../image_similarity/export-coreml.html" class="navigation navigation-prev " aria-label="Previous page: Deployment to Core ML">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="data-preparation.html" class="navigation navigation-next " aria-label="Next page: Data Preparation">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Object detection","level":"1.3.6","depth":2,"next":{"title":"Data Preparation","level":"1.3.6.1","depth":3,"path":"object_detection/data-preparation.md","ref":"object_detection/data-preparation.md","articles":[]},"previous":{"title":"Deployment to Core ML","level":"1.3.5.1","depth":3,"path":"image_similarity/export-coreml.md","ref":"image_similarity/export-coreml.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"3.2.0","theme":"default","variables":{},"plugins":["collapsible-menu@1.0.2","anchors@0.5.0","mathjax"],"pluginsConfig":{"collapsible-menu":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"fontSettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"object_detection/README.md","mtime":"2018-08-23T20:45:42.462Z","type":"markdown"},"gitbook":{"version":"3.2.0","time":"2019-04-11T18:53:55.756Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

